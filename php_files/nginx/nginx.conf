server {
    # CRITICAL FIX: The platform's health check failed because it uses port 8080. 
    # Nginx must listen on this port instead of the default 80.
    listen 8080;
    server_name localhost;

    # Set the web root where your application files were copied
    root /var/www/html;
    index index.php index.html index.htm;

    # Set the maximum file size for uploads
    client_max_body_size 100M; 
    
    # Handle files and directories that exist
    location / {
        try_files $uri $uri/ =404;
    }

    # Pass all .php files to the PHP-FPM service
    location ~ \.php$ {
        # Ensure the web root is set inside this location block too
        root /var/www/html; 
        
        # CRITICAL: This MUST match the port PHP-FPM is listening on (9000, by default)
        fastcgi_pass 127.0.0.1:9000;
        
        # Standard FastCGI parameters
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        
        # Set specific timeouts if needed
        fastcgi_read_timeout 300;
    }

    # Deny access to hidden files (dotfiles)
    location ~ /\. {
        deny all;
    }

    # Deny access to files with an extension of .log or .ini for security
    location ~* \.(log|ini|json|md)$ {
        deny all;
    }
}